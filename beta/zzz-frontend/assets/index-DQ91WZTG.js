import{aK as C,z as D,am as J,an as U,ao as Z,ap as F,d as H,a as n,j as e,T as b,b as g,ay as O,G as l,aH as Q,C as j,u as X,r as a,l as Y,d9 as ee,B as p,cj as te,i as k,c as f,aA as ae,da as ne}from"./index-CKARXDv9.js";const re=C(D.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),oe=C(D.jsx("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download"),se=C(D.jsx("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),le=C(D.jsx("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");var x={},W;function ce(){if(W)return x;W=1;var o=J();Object.defineProperty(x,"__esModule",{value:!0}),x.default=void 0;var c=o(U()),i=Z(),m=(0,c.default)((0,i.jsx)("path",{d:"M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"}),"ContentPaste");return x.default=m,x}var ie=ce();const de=F(ie);function ue(){const{t:o}=H("page_settings");return n(j,{bgt:"light",children:[e(g,{sx:{py:1},children:e(b,{variant:"subtitle1",children:o("DatabaseCard.title")})}),e(O,{}),e(g,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(l,{container:!0,spacing:2,columns:{xs:1,md:2},children:Q(0,3).map(c=>e(l,{item:!0,xs:1,children:e(he,{index:c})},c))})})]})}function he({index:o}){const{databases:c,database:i,setDatabase:m}=X(),t=c[o],[{name:s,lastEdit:I},E]=a.useState(t.dbMeta.get());a.useEffect(()=>t.dbMeta.follow((h,S)=>E(S)),[t]),a.useEffect(()=>E(t.dbMeta.get()),[t]);const d=i===t,[R,V,M]=Y(),{t:r}=H("page_settings"),B=t.chars.keys.length,_=t.discs.keys.length,z=t.wengines.keys.length,v=!!(B||_||z),P=a.useCallback(()=>navigator.clipboard.writeText(JSON.stringify(t.exportZOD())).then(()=>alert("Copied database to clipboard.")).catch(console.error),[t]),q=a.useCallback(()=>{window.confirm(`Are you sure you want to delete "${s}"?`)&&(t.clear(),t.toExtraLocalDB())},[t,s]),$=a.useCallback(()=>{const S=new Date().toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),N=JSON.stringify(t.exportZOD()),A=`${s.trim().replaceAll(" ","_")}_${S}.json`,G="application/json;charset=utf-8",u=document.createElement("a");u.download=A,u.href=`data:${G},${encodeURIComponent(N)}`,u.target="_blank",document.body.appendChild(u),u.click(),document.body.removeChild(u)},[t,s]),K=a.useCallback(()=>{d||(i.toExtraLocalDB(),t.swapStorage(i),m(o,t))},[o,m,i,d,t]),[y,T]=a.useState(s);a.useEffect(()=>T(s),[s]);const w=a.useCallback(()=>{t.dbMeta.set({name:y}),t.toExtraLocalDB()},[y,t]),L=a.useCallback(h=>h.key==="Enter"&&w(),[w]);return n(j,{sx:{height:"100%",boxShadow:d?"0px 0px 0px 2px green inset":void 0},children:[n(g,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[e(ee,{value:y,sx:{borderRadius:1,px:1,flexGrow:1},onChange:h=>T(h.target.value),onBlur:w,onKeyDown:L}),!d&&e(p,{startIcon:e(se,{}),onClick:K,color:"warning",children:r("DatabaseCard.button.swap")}),e(te,{color:d?"success":"secondary",sx:{alignSelf:"center"},label:d?r("DatabaseCard.currentDB"):`${r("DatabaseCard.title")} ${t.dbIndex}`})]}),e(O,{}),e(g,{children:n(k,{display:"flex",gap:2,children:[n(k,{flexGrow:1,children:[n(b,{noWrap:!0,children:[e(f,{t:r,i18nKey:"count.chars"})," ",e("strong",{children:B})]}),n(b,{noWrap:!0,children:[e(f,{t:r,i18nKey:"count.discs"})," ",e("strong",{children:_})]}),n(b,{noWrap:!0,children:[e(f,{t:r,i18nKey:"count.wengines"})," ",e("strong",{children:z})]})]}),n(k,{children:[n(l,{container:!0,spacing:1,columns:{xs:2},children:[e(l,{item:!0,xs:1,children:e(p,{fullWidth:!0,disabled:!v,color:"info",onClick:P,startIcon:e(de,{}),children:e(f,{t:r,i18nKey:"DatabaseCard.button.copy"})})}),n(l,{item:!0,xs:1,children:[e(ae,{open:R,onClose:M,children:e(ne,{index:o,onReplace:M})}),e(p,{fullWidth:!0,component:"span",color:"info",startIcon:e(le,{}),onClick:V,children:r("DatabaseCard.button.upload")})]}),e(l,{item:!0,xs:1,children:e(p,{fullWidth:!0,disabled:!v,onClick:$,startIcon:e(oe,{}),children:r("DatabaseCard.button.download")})}),e(l,{item:!0,xs:1,children:e(p,{fullWidth:!0,disabled:!v,color:"error",onClick:q,startIcon:e(re,{}),children:r("DatabaseCard.button.delete")})})]}),!!I&&e(b,{noWrap:!0,align:"center",style:{paddingTop:"1.5em"},children:e("strong",{children:new Date(I).toLocaleString()})})]})]})})]})}function xe(){return e(j,{sx:{my:1},children:e(g,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(ue,{})})})}export{xe as default};
