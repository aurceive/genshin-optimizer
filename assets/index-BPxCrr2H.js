import{y as B,r as a,aZ as J,a as W,bI as Q,b as e,bK as V,ci as R,ar as L,b4 as Z,cP as D,Q as q,S as I,cQ as X,g as Y,z as ee,cR as se,ab as te,bA as ie,aD as ae,aE as re,aA as le,aF as ne,f as K,N as _,B as S,bj as F,aH as oe,ad as A,aI as me,ag as ue,L as ce,M as he,T as ge,G as $,cS as de}from"./index-CihC3QCq.js";import{T as pe}from"./TeamCard-B7WDIGTP.js";import{d as P}from"./Upload-CoKllus-.js";import"./consts-DDeIGJse.js";import"./TeamDelModal-BTjCnK2x.js";import"./Settings-CJHuoLGc.js";function be({teamIds:n,charKeys:i,setCharKey:m,acProps:o}){const{t:u}=B(["sillyWisher_charNames","charNames_gen"]),{silly:f}=a.useContext(J),r=W(),{gender:c}=Q(),h=a.useCallback(s=>r.charMeta.get(s).favorite,[r.charMeta]),v=a.useCallback(s=>e(V,{characterKey:s},void 0,!1,{fileName:"C:/Users/kulay/Git/genshin-optimizer/libs/gi/ui/src/components/character/CharacterMultiAutocomplete.tsx",lineNumber:40,columnNumber:28},this),[]),k=a.useCallback((s,l)=>u(`${l?"sillyWisher_charNames":"charNames_gen"}:${R(s,c)}`),[c,u]),z=Y,[T,x]=L();a.useEffect(()=>r.chars.followAny((s,l)=>["new","remove"].includes(l)&&x()),[r.chars,x]);const g=a.useMemo(()=>T&&r.chars.keys,[r,T]),{characterTeamTotal:d}=a.useMemo(()=>Z({characterTeamTotal:g},l=>{r.teams.values.forEach(G=>{const{loadoutData:N}=G;N.filter(D).forEach(({teamCharId:U})=>{const p=r.teamChars.get(U);if(!p)return;const C=p.key;l.characterTeamTotal[C].total++})}),n.forEach(G=>{const N=r.teams.get(G);if(!N)return;const{loadoutData:U}=N;U.filter(D).forEach(({teamCharId:p})=>{const C=r.teamChars.get(p);if(!C)return;const M=C.key;l.characterTeamTotal[M].current++})})}),[r,g,n]),w=a.useCallback(s=>e("strong",{children:d[s]},void 0,!1,{fileName:"C:/Users/kulay/Git/genshin-optimizer/libs/gi/ui/src/components/character/CharacterMultiAutocomplete.tsx",lineNumber:98,columnNumber:28},this),[d]),E=a.useCallback(s=>e(q,{size:"small",label:d[s]},void 0,!1,{fileName:"C:/Users/kulay/Git/genshin-optimizer/libs/gi/ui/src/components/character/CharacterMultiAutocomplete.tsx",lineNumber:103,columnNumber:7},this),[d]),y=a.useMemo(()=>g.map(s=>({key:s,label:k(s,f),alternateNames:f?[k(s,!f)]:void 0,favorite:h(s),color:z(s)})).sort((s,l)=>s.favorite&&!l.favorite?-1:!s.favorite&&l.favorite?1:s.label.localeCompare(l.label)),[f,k,z,h,g]);return e(a.Suspense,{fallback:e(I,{variant:"text",width:100},void 0,!1,{fileName:"C:/Users/kulay/Git/genshin-optimizer/libs/gi/ui/src/components/character/CharacterMultiAutocomplete.tsx",lineNumber:129,columnNumber:25},this),children:e(X,{label:"Characters",options:y,toImg:v,valueKeys:i,onChange:s=>m(s),toExLabel:w,toExItemLabel:E,chipProps:{variant:"outlined"},...o},void 0,!1,{fileName:"C:/Users/kulay/Git/genshin-optimizer/libs/gi/ui/src/components/character/CharacterMultiAutocomplete.tsx",lineNumber:130,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/kulay/Git/genshin-optimizer/libs/gi/ui/src/components/character/CharacterMultiAutocomplete.tsx",lineNumber:129,columnNumber:5},this)}function fe(){return{name:n=>n.name??"",lastEdit:n=>n.lastEdit??0}}const Ne={name:["name","lastEdit"],lastEdit:["lastEdit"]};function xe(n){return{charKeys:(i,m)=>{var r;if(!m.length)return!0;const o=(r=n.teams.get(i))==null?void 0:r.loadoutData.filter(D),u=o==null?void 0:o.map(({teamCharId:c})=>{var h;return(h=n.teamChars.get(c))==null?void 0:h.key}).filter(D);return m.every(c=>u==null?void 0:u.includes(c))},name:(i,m)=>{var o;return!m||!!((o=n.teams.get(i))!=null&&o.name.toLowerCase().includes(m.toLowerCase()))}}}const ye={xs:1,sm:2,md:2,lg:3,xl:3},Ce={xs:6,sm:12,md:18,lg:24,xl:24};function we(){const{t:n}=B(["page_teams","sillyWisher_charNames","charNames_gen"]),i=W(),[m,o]=L(),u=ee();a.useEffect(()=>i.teams.followAny((t,b)=>(b==="new"||b==="remove"||b==="update")&&o()),[o,i]),se();const f=()=>{const t=i.teams.new();u(t)},[r,c,h]=te(),[v,k]=a.useState(""),z=()=>{try{const t=JSON.parse(v);i.teams.import(t)||window.alert("Data verification failed."),h()}catch(t){window.alert(`Data Import failed. ${t}`);return}},T=ie(i.displayTeam),{sortType:x,ascending:g,charKeys:d}=T,[w,E]=a.useState(T.searchTerm),y=a.useDeferredValue(w);a.useEffect(()=>{i.displayTeam.set({searchTerm:y})},[i,y]);const{teamIds:s,totalTeamNum:l}=a.useMemo(()=>{const t=i.teams.keys.length,b=i.teams.keys.filter(ae({charKeys:d,name:y},xe(i))).sort((j,H)=>re(Ne[x],g,fe())(i.teams.get(j),i.teams.get(H)));return m&&{teamIds:b,totalTeamNum:t}},[m,i,d,y,x,g]),G=le(),{numShow:N,setTriggerElement:U}=ne(Ce[G],s.length),p=a.useMemo(()=>s.slice(0,N),[s,N]),C=s.length!==l?`${s.length}/${l}`:`${l}`,M={numShowing:p.length,total:C,t:n,namespace:"page_teams"},O={sortKeys:[...de],value:x,onChange:t=>i.displayTeam.set({sortType:t}),ascending:g,onChangeAsc:t=>i.displayTeam.set({ascending:t})};return e(S,{display:"flex",flexDirection:"column",gap:1,children:[e(K,{children:e(_,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(S,{display:"flex",gap:1,alignItems:"stretch",children:[e(be,{teamIds:s,charKeys:d,setCharKey:t=>i.displayTeam.set({charKeys:t}),acProps:{sx:{flexGrow:1}}},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:148,columnNumber:13},this),e(F,{autoFocus:!0,value:w,onChange:t=>E(t.target.value),label:"Team Name",sx:{height:"100%",flexGrow:1},InputProps:{sx:{height:"100%"}}},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:154,columnNumber:13},this)]},void 0,!0,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:147,columnNumber:11},this),e(S,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:e(oe,{showingTextProps:M,sortByButtonProps:O},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:174,columnNumber:13},this)},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:168,columnNumber:11},this)]},void 0,!0,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:146,columnNumber:9},this)},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:145,columnNumber:7},this),e(S,{sx:{display:"flex",gap:1},children:[e(A,{fullWidth:!0,onClick:f,color:"info",startIcon:e(me,{},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:183,columnNumber:67},this),children:"Add Team"},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:183,columnNumber:9},this),e(ue,{open:r,onClose:h,children:e(K,{children:[e(ce,{title:"Import Team"},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:188,columnNumber:13},this),e(he,{},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:189,columnNumber:13},this),e(_,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(ge,{children:"Import a team in JSON form below."},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:193,columnNumber:15},this),e(F,{fullWidth:!0,label:"JSON Data",placeholder:"Paste your Team JSON here",value:v,onChange:t=>k(t.target.value),multiline:!0,rows:4},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:194,columnNumber:15},this),e(A,{startIcon:e(P,{},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:204,columnNumber:28},this),disabled:!v,onClick:z,children:"Import"},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:203,columnNumber:15},this)]},void 0,!0,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:190,columnNumber:13},this)]},void 0,!0,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:187,columnNumber:11},this)},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:186,columnNumber:9},this),e(A,{fullWidth:!0,onClick:c,color:"info",startIcon:e(P,{},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:217,columnNumber:22},this),children:"Import Team"},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:213,columnNumber:9},this)]},void 0,!0,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:182,columnNumber:7},this),e(a.Suspense,{fallback:e(I,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:224,columnNumber:11},this),children:e($,{container:!0,spacing:2,columns:ye,children:p.map(t=>e($,{item:!0,xs:1,children:e(a.Suspense,{fallback:e(I,{variant:"rectangular",width:"100%",height:150},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:235,columnNumber:19},this),children:e(pe,{teamId:t,bgt:"light",onClick:b=>u(`${t}${b?`/${b}`:""}`)},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:238,columnNumber:17},this)},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:233,columnNumber:15},this)},t,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:232,columnNumber:13},this))},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:230,columnNumber:9},this)},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:222,columnNumber:7},this),s.length!==p.length&&e(I,{ref:t=>{t&&U(t)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100},void 0,!1,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:249,columnNumber:9},this)]},void 0,!0,{fileName:"C:\\Users\\kulay\\Git\\genshin-optimizer\\libs\\gi\\page-teams\\src\\index.tsx",lineNumber:144,columnNumber:5},this)}export{we as default};
